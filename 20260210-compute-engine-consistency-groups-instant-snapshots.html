<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Compute Engine: Consistency Groups for Instant Snapshots (Preview)</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700&display=swap');

    /* Google Cloud Light Theme Base Styles */
    :root {
      --gc-blue: #4285F4;
      --gc-red: #EA4335;
      --gc-yellow: #FBBC04;
      --gc-green: #34A853;
      --gc-blue-900: #174EA6;
      --gc-blue-800: #185ABC;
      --gc-blue-700: #1967D2;
      --gc-blue-600: #1A73E8;
      --gc-blue-500: #4285F4;
      --gc-blue-300: #669DF6;
      --gc-blue-200: #8AB4F8;
      --gc-blue-100: #AECBFA;
      --gc-blue-50: #E8F0FE;
      --gc-on-surface: #202124;
      --gc-on-surface-variant: #5F6368;
      --gc-outline: #80868B;
      --gc-surface: #FFFFFF;
      --gc-surface-container-lowest: #F8F9FA;
      --gc-surface-container-low: #F1F3F4;
      --gc-surface-container: #E8EAED;
      --gc-outline-variant: #DADCE0;
      --gc-blue-tint: #E8F0FE;
      --gc-green-tint: #E6F4EA;
      --gc-red-tint: #FCE8E6;
      --gc-yellow-tint: #FEF7E0;
      --gc-purple-tint: #F3E8FD;
      --gc-teal-tint: #E0F7FA;
      --gc-purple: #A142F4;
      --gc-teal: #00BCD4;
      --gc-orange: #FF6D00;
    }

    * { box-sizing: border-box; }

    body {
      background-color: var(--gc-surface);
      font-family: 'Google Sans', 'Noto Sans JP', 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
      color: var(--gc-on-surface-variant);
      font-size: 16px;
      line-height: 1.7;
      padding: 20px;
      margin: 0;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
      width: 100%;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 32px;
      flex-wrap: wrap;
      padding-bottom: 16px;
      border-bottom: 3px solid var(--gc-blue-600);
    }

    .header-left { flex: 1; min-width: 280px; }

    h1 {
      font-size: 36px;
      font-weight: 700;
      color: var(--gc-on-surface);
      margin: 0 0 8px 0;
      line-height: 1.3;
    }

    .header-meta {
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
      margin-top: 8px;
    }

    h2 {
      font-size: 24px;
      font-weight: 600;
      color: var(--gc-on-surface);
      margin: 0 0 16px 0;
      display: flex;
      align-items: center;
      gap: 8px;
      padding-bottom: 8px;
      border-bottom: 2px solid var(--gc-blue-600);
    }

    h3 {
      font-size: 18px;
      font-weight: 600;
      color: var(--gc-on-surface);
      margin: 16px 0 8px 0;
    }

    .subtitle {
      font-size: 16px;
      color: var(--gc-outline);
      text-align: right;
    }

    .section {
      background: var(--gc-surface-container-low);
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 24px;
      border: 1px solid var(--gc-outline-variant);
    }

    .highlight {
      background-color: var(--gc-blue-50);
      padding: 2px 8px;
      border-radius: 4px;
      font-weight: 600;
      color: var(--gc-blue-800);
      border-bottom: 2px solid var(--gc-blue-600);
    }

    .card {
      background: var(--gc-surface);
      border-radius: 12px;
      padding: 20px;
      margin: 12px 0;
      border-left: 4px solid var(--gc-blue-600);
      box-shadow: 0 1px 3px rgba(60, 64, 67, 0.12), 0 1px 2px rgba(60, 64, 67, 0.08);
    }

    .card-green {
      border-left-color: var(--gc-green);
    }

    .card-orange {
      border-left-color: var(--gc-orange);
    }

    .card-red {
      border-left-color: var(--gc-red);
    }

    .icon-text {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      margin: 8px 0;
      color: var(--gc-on-surface-variant);
    }

    .badge,
    .badge-ga,
    .badge-preview,
    .badge-deprecated {
      display: inline-block;
      color: #FFFFFF;
      padding: 4px 12px;
      border-radius: 16px;
      font-size: 13px;
      font-weight: 500;
      letter-spacing: 0.25px;
      margin: 4px 8px 4px 0;
    }

    .badge { background: var(--gc-blue-600); }
    .badge-preview { background: var(--gc-orange); color: #FFFFFF; }

    /* Before/After */
    .before-after { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin: 16px 0; }
    .before-card {
      background: var(--gc-red-tint);
      border-left: 4px solid var(--gc-red);
      border-radius: 0 12px 12px 0;
      padding: 16px 20px;
    }
    .after-card {
      background: var(--gc-green-tint);
      border-left: 4px solid var(--gc-green);
      border-radius: 0 12px 12px 0;
      padding: 16px 20px;
    }
    .before-card h3 { color: var(--gc-red); margin-top: 0; }
    .after-card h3 { color: var(--gc-green); margin-top: 0; }

    /* Stat cards */
    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin: 16px 0; }
    .stat-card {
      background: linear-gradient(135deg, var(--gc-blue-600), var(--gc-blue-800));
      color: var(--gc-surface);
      border-radius: 12px;
      padding: 24px;
      text-align: center;
    }
    .stat-value { font-size: 36px; font-weight: 700; margin-bottom: 4px; }
    .stat-label { font-size: 14px; opacity: 0.9; }

    /* Feature cards grid */
    .features-grid { display: grid; grid-template-columns: 1fr; gap: 12px; }

    /* Flow diagram */
    .flow-diagram {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      flex-wrap: wrap;
      margin: 24px 0;
    }
    .flow-step {
      background: var(--gc-surface);
      border: 2px solid var(--gc-blue-600);
      border-radius: 12px;
      padding: 12px 20px;
      text-align: center;
      min-width: 100px;
      color: var(--gc-on-surface);
      box-shadow: 0 1px 3px rgba(60, 64, 67, 0.12);
    }
    .flow-arrow { color: var(--gc-blue-600); font-size: 24px; font-weight: bold; }

    /* Mermaid container */
    .mermaid-container {
      background: #FFFFFF;
      border-radius: 12px;
      padding: 24px;
      margin: 20px 0;
      border: 2px solid rgba(66, 133, 244, 0.3);
      overflow-x: auto;
    }
    .mermaid { display: flex; justify-content: center; }

    /* Tables */
    table { width: 100%; border-collapse: collapse; margin: 16px 0; border-radius: 8px; overflow: hidden; border: 1px solid var(--gc-outline-variant); }
    th { background: var(--gc-blue-50); color: var(--gc-blue-900); padding: 12px 16px; text-align: left; font-weight: 600; font-size: 14px; border-bottom: 2px solid var(--gc-blue-200); }
    td { padding: 12px 16px; border-bottom: 1px solid var(--gc-outline-variant); font-size: 14px; }
    tr:nth-child(even) { background: var(--gc-surface-container-lowest); }
    tr:hover { background: var(--gc-blue-50); }

    /* Code blocks */
    .code-block {
      background: #1E1E1E;
      border-radius: 8px;
      overflow: hidden;
      margin: 16px 0;
    }
    .code-header {
      background: #2D2D2D;
      padding: 8px 16px;
      display: flex;
      justify-content: space-between;
      font-size: 12px;
    }
    .code-lang { color: #9CDCFE; font-weight: bold; }
    .code-title { color: #AAAAAA; }
    .code-block pre { margin: 0; padding: 0; overflow-x: auto; background: #1E1E1E; border-radius: 0; }
    .code-block code {
      font-family: 'Roboto Mono', 'Source Code Pro', 'Courier New', monospace;
      font-size: 15px;
      line-height: 1.6;
      padding: 16px !important;
    }

    pre:not(.mermaid) {
      background: #1E1E1E;
      border-radius: 8px;
      padding: 16px;
      font-family: 'Roboto Mono', 'Source Code Pro', 'Courier New', monospace;
      font-size: 15px;
      line-height: 1.6;
      overflow-x: auto;
      color: #E8E8E8;
      margin: 16px 0;
    }

    pre code {
      background: none;
      border: none;
      padding: 0;
      font-size: inherit;
      color: inherit;
    }

    code:not(pre code) {
      background: var(--gc-surface-container-low);
      border: 1px solid var(--gc-outline-variant);
      border-radius: 4px;
      padding: 2px 6px;
      font-family: 'Roboto Mono', 'Source Code Pro', 'Courier New', monospace;
      font-size: 0.9em;
      color: var(--gc-blue-900);
    }

    /* Note/Warning boxes */
    .note-box { background: var(--gc-blue-tint); border-left: 4px solid var(--gc-blue-600); padding: 16px 20px; border-radius: 0 12px 12px 0; margin: 16px 0; }
    .warning-box { background: var(--gc-yellow-tint); border-left: 4px solid var(--gc-yellow); padding: 16px 20px; border-radius: 0 12px 12px 0; margin: 16px 0; }
    .error-box { background: var(--gc-red-tint); border-left: 4px solid var(--gc-red); padding: 16px 20px; border-radius: 0 12px 12px 0; margin: 16px 0; }
    .success-box { background: var(--gc-green-tint); border-left: 4px solid var(--gc-green); padding: 16px 20px; border-radius: 0 12px 12px 0; margin: 16px 0; }

    /* Usecase cards */
    .usecase-card {
      background: var(--gc-blue-tint);
      border-radius: 12px;
      padding: 20px;
      margin: 12px 0;
      border: 1px solid var(--gc-blue-200);
    }
    .usecase-card h3 { color: var(--gc-blue-800); margin-top: 0; }

    /* Links */
    .gc-link { color: var(--gc-blue-600); text-decoration: none; }
    .gc-link:hover { color: var(--gc-blue-800); text-decoration: underline; }

    /* IAM permissions list */
    .permissions-list { list-style: none; padding: 0; margin: 0; }
    .permissions-list li { padding: 6px 0; border-bottom: 1px solid var(--gc-outline-variant); font-size: 14px; display: flex; gap: 8px; }
    .permissions-list li:last-child { border-bottom: none; }
    .perm-name { font-family: 'Roboto Mono', monospace; font-size: 13px; color: var(--gc-blue-900); background: var(--gc-blue-50); padding: 2px 6px; border-radius: 4px; white-space: nowrap; }
    .perm-desc { color: var(--gc-on-surface-variant); }

    /* Related services */
    .related-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 12px; }
    .related-card {
      background: var(--gc-surface);
      border: 1px solid var(--gc-outline-variant);
      border-radius: 12px;
      padding: 16px;
      transition: box-shadow 0.2s;
    }
    .related-card:hover { box-shadow: 0 2px 8px rgba(60, 64, 67, 0.2); }
    .related-card h4 { margin: 0 0 8px 0; color: var(--gc-on-surface); font-size: 15px; }
    .related-card p { margin: 0; font-size: 13px; color: var(--gc-outline); }

    footer {
      margin-top: 24px;
      padding-top: 16px;
      border-top: 1px solid var(--gc-outline-variant);
      font-size: 12px;
      color: var(--gc-outline);
    }
    footer a { color: var(--gc-blue-600); text-decoration: underline; word-break: break-all; }
    footer ul { list-style: none; padding: 0; margin: 8px 0; }
    footer li { margin: 4px 0; }

    @media (max-width: 768px) {
      h1 { font-size: 26px; }
      .before-after { grid-template-columns: 1fr; }
      .stats-grid { grid-template-columns: 1fr; }
      .header { flex-direction: column; }
      .subtitle { text-align: left; margin-top: 8px; }
      .related-grid { grid-template-columns: 1fr; }
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/vs2015.min.css">
</head>
<body>
  <div class="container">

    <!-- Header -->
    <div class="header">
      <div class="header-left">
        <h1>&#x2601;&#xFE0F; Compute Engine: Consistency Groups for Instant Snapshots</h1>
        <div class="header-meta">
          <span class="badge">Compute Engine</span>
          <span class="badge-preview">Preview</span>
        </div>
      </div>
      <div class="subtitle">2026-02-10</div>
    </div>

    <!-- Overview -->
    <div class="section">
      <h2>&#x1F4CB; 概要</h2>
      <p>Compute Engine に<span class="highlight">Consistency Groups for Instant Snapshots</span>機能が Preview として追加されました。複数のディスクを<strong>同一時点</strong>でまとめてバックアップし、データの整合性を保証できるようになります。</p>
      <p>従来のインスタントスナップショットは個別のディスク単位での取得のみに対応していましたが、本機能ではディスクのコンシステンシーグループを作成し、そのグループ全体に対して<strong>単一のオペレーション</strong>でインスタントスナップショットを取得できます。</p>
      <p>複数ディスクにまたがるワークロード (データベース、分散アプリケーションなど) を運用するユーザーを主な対象としており、RPO (Recovery Point Objective) を大幅に短縮できます。コンシステンシーグループのインスタントスナップショットは<strong>追加コストなし</strong>で利用できます。</p>
    </div>

    <!-- Before/After -->
    <div class="section">
      <h2>&#x1F504; Before / After 比較</h2>
      <div class="before-after">
        <div class="before-card">
          <h3>&#x274C; Before (従来)</h3>
          <div class="icon-text"><span>&#x2022;</span><span>各ディスクのスナップショットを個別に取得する必要があり、取得タイミングにずれが生じてデータの整合性を保証できなかった</span></div>
          <div class="icon-text"><span>&#x2022;</span><span>複数ディスクの一括リストアには手動で各ディスクを個別に復元する手順が必要であり、復旧時間 (RTO) が長くなる傾向があった</span></div>
          <div class="icon-text"><span>&#x2022;</span><span>マシンイメージを使った一括バックアップは可能だったが、インスタントスナップショットほどの高速な復元は実現できなかった</span></div>
        </div>
        <div class="after-card">
          <h3>&#x2705; After (新機能)</h3>
          <div class="icon-text"><span>&#x2022;</span><span>コンシステンシーグループに属する全ディスクのインスタントスナップショットを、単一のオペレーションで同一時点に取得できる</span></div>
          <div class="icon-text"><span>&#x2022;</span><span>コンシステンシーグループのインスタントスナップショットから複数ディスクを一括でリストアでき、復旧時間が大幅に短縮される</span></div>
          <div class="icon-text"><span>&#x2022;</span><span>追加コストなしでコンシステンシーグループのインスタントスナップショット機能を利用できる</span></div>
        </div>
      </div>
    </div>

    <!-- Stats -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-value">128</div>
        <div class="stat-label">1グループあたり最大ディスク数</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">32</div>
        <div class="stat-label">ディスクあたり最大スナップショット数</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">30秒</div>
        <div class="stat-label">最低スナップショット間隔</div>
      </div>
      <div class="stat-card" style="background: linear-gradient(135deg, var(--gc-green), #1B8A3E);">
        <div class="stat-value">&#x00A5;0</div>
        <div class="stat-label">追加コスト</div>
      </div>
    </div>

    <!-- Architecture Diagram (Mermaid) -->
    <div class="section">
      <h2>&#x1F3D7;&#xFE0F; アーキテクチャ図</h2>
      <p>コンシステンシーグループに含まれる複数ディスクに対して、単一のオペレーションで同一時点のインスタントスナップショットを作成し、必要に応じて一括リストアするフローを示しています。</p>
      <div class="mermaid-container">
        <pre class="mermaid">
flowchart TD
    subgraph CG["Consistency Group"]
        D1["Disk A"]
        D2["Disk B"]
        D3["Disk C"]
    end

    OP["instant-snapshot-groups create"]

    CG --> OP

    subgraph ISG["Consistency Group of Instant Snapshots"]
        IS1["Instant Snapshot A"]
        IS2["Instant Snapshot B"]
        IS3["Instant Snapshot C"]
    end

    OP --> ISG

    RESTORE["disks bulk create"]

    ISG --> RESTORE

    subgraph NEWDISKS["Restored Disks"]
        ND1["New Disk A"]
        ND2["New Disk B"]
        ND3["New Disk C"]
    end

    RESTORE --> NEWDISKS
        </pre>
      </div>
    </div>

    <!-- Key Features -->
    <div class="section">
      <h2>&#x2B50; 主要機能</h2>
      <div class="features-grid">
        <div class="card">
          <h3>&#x1F4F8; 同時バックアップ (Simultaneous Backups)</h3>
          <div class="icon-text"><span>&#x2192;</span><span>コンシステンシーグループに属する全ディスクのインスタントスナップショットを、1 回のオペレーションで同一タイムスタンプにて取得</span></div>
          <div class="icon-text"><span>&#x2192;</span><span>ゾーンディスクとリージョナルディスクの両方に対応</span></div>
          <div class="icon-text"><span>&#x2192;</span><span><code>gcloud beta compute instant-snapshot-groups create</code> コマンドまたは REST API で実行可能</span></div>
        </div>
        <div class="card card-green">
          <h3>&#x1F504; 一括リストア (Bulk Restoration)</h3>
          <div class="icon-text"><span>&#x2192;</span><span>コンシステンシーグループのインスタントスナップショットから、全ディスクを一括で復元</span></div>
          <div class="icon-text"><span>&#x2192;</span><span><code>gcloud beta compute disks bulk create</code> コマンドまたは REST API (<code>disks.bulkInsert</code>) で実行可能</span></div>
          <div class="icon-text"><span>&#x2192;</span><span>復元後のディスクは、必要に応じて新しいコンシステンシーグループに追加可能</span></div>
        </div>
        <div class="card card-orange">
          <h3>&#x1F5C2;&#xFE0F; コンシステンシーグループの管理</h3>
          <div class="icon-text"><span>&#x2192;</span><span>インスタントスナップショットグループの一覧表示、詳細確認、削除が可能</span></div>
          <div class="icon-text"><span>&#x2192;</span><span>コンシステンシーグループ内の個別のインスタントスナップショットの確認も可能</span></div>
          <div class="icon-text"><span>&#x2192;</span><span>コンシステンシーグループの削除時には、グループ内の全インスタントスナップショットも同時に削除される</span></div>
        </div>
      </div>
    </div>

    <!-- Technical Specifications -->
    <div class="section">
      <h2>&#x1F527; 技術仕様</h2>

      <h3>&#x1F4BE; 対応ディスクタイプ</h3>
      <table>
        <thead>
          <tr><th>ディスクタイプ</th><th>対応状況</th></tr>
        </thead>
        <tbody>
          <tr><td>Hyperdisk Balanced</td><td style="color: var(--gc-green); font-weight: 600;">&#x2705; 対応</td></tr>
          <tr><td>Hyperdisk Balanced High Availability</td><td style="color: var(--gc-green); font-weight: 600;">&#x2705; 対応</td></tr>
          <tr><td>Hyperdisk Extreme</td><td style="color: var(--gc-green); font-weight: 600;">&#x2705; 対応</td></tr>
          <tr><td>Persistent Disk (Extreme PD 含む)</td><td style="color: var(--gc-green); font-weight: 600;">&#x2705; 対応</td></tr>
          <tr><td>Hyperdisk Throughput</td><td style="color: var(--gc-red); font-weight: 600;">&#x274C; 非対応</td></tr>
          <tr><td>Hyperdisk ML</td><td style="color: var(--gc-red); font-weight: 600;">&#x274C; 非対応</td></tr>
        </tbody>
      </table>

      <h3>&#x1F4CF; コンシステンシーグループの制約</h3>
      <table>
        <thead>
          <tr><th>項目</th><th>詳細</th></tr>
        </thead>
        <tbody>
          <tr><td>最大ディスク数</td><td>1 コンシステンシーグループあたり <strong>128 ディスク</strong></td></tr>
          <tr><td>ディスクの場所</td><td>ゾーンディスクは同一ゾーン、リージョナルディスクは同一ゾーンペア</td></tr>
          <tr><td>プロジェクト</td><td>全ディスクがコンシステンシーグループと同一プロジェクトに属する必要あり</td></tr>
          <tr><td>VM あたりの制限</td><td>異なるコンシステンシーグループのディスクを最大 <strong>16 個</strong>まで接続可能 (同一グループのディスクは 1 としてカウント)</td></tr>
          <tr><td>個別ディスクの制限</td><td>ディスクあたり最大 <strong>32 個</strong>のインスタントスナップショット</td></tr>
          <tr><td>スナップショット間隔</td><td>ディスクあたり最低 <strong>30 秒</strong>間隔</td></tr>
          <tr><td>データ整合性</td><td><span class="highlight">クラッシュ整合性</span> (アプリケーション整合性ではない)</td></tr>
        </tbody>
      </table>

      <h3>&#x1F512; 必要な IAM 権限</h3>
      <div class="card">
        <ul class="permissions-list">
          <li><span class="perm-name">compute.instantSnapshotGroups.create</span><span class="perm-desc">スナップショット作成</span></li>
          <li><span class="perm-name">compute.instantSnapshotGroups.list</span><span class="perm-desc">スナップショット一覧</span></li>
          <li><span class="perm-name">compute.instantSnapshotGroups.get</span><span class="perm-desc">スナップショット詳細</span></li>
          <li><span class="perm-name">compute.instantSnapshotGroups.delete</span><span class="perm-desc">スナップショット削除</span></li>
          <li><span class="perm-name">compute.instantSnapshotGroups.useReadOnly</span><span class="perm-desc">リストア時に必要</span></li>
          <li><span class="perm-name">compute.instantSnapshots.useReadOnly</span><span class="perm-desc">リストア時に必要</span></li>
          <li><span class="perm-name">compute.resourcePolicies.useReadOnly</span><span class="perm-desc">リストア時に必要</span></li>
          <li><span class="perm-name">compute.disks.create</span><span class="perm-desc">ディスク復元時に必要</span></li>
        </ul>
        <div class="note-box" style="margin-top: 12px;">
          <strong>&#x1F4A1; 推奨 IAM ロール:</strong> <code>roles/compute.instanceAdmin.v1</code> (Compute Instance Admin v1)
        </div>
      </div>
    </div>

    <!-- Setup Steps -->
    <div class="section">
      <h2>&#x2699;&#xFE0F; 設定方法</h2>

      <h3>前提条件</h3>
      <div class="icon-text"><span>1.</span><span>Google Cloud プロジェクトで Compute Engine API が有効化されていること</span></div>
      <div class="icon-text"><span>2.</span><span><code>roles/compute.instanceAdmin.v1</code> ロールが付与されていること</span></div>
      <div class="icon-text"><span>3.</span><span>gcloud CLI の beta コンポーネントがインストールされていること</span></div>

      <h3>ステップ 1: コンシステンシーグループの作成</h3>
      <div class="code-block">
        <div class="code-header">
          <span class="code-lang">Bash</span>
          <span class="code-title">コンシステンシーグループ (リソースポリシー) を作成</span>
        </div>
        <pre><code class="language-bash"># コンシステンシーグループ (リソースポリシー) を作成
gcloud compute resource-policies create disk-consistency-group my-consistency-group \
    --region=us-central1</code></pre>
      </div>

      <h3>ステップ 2: ディスクをコンシステンシーグループに追加</h3>
      <div class="code-block">
        <div class="code-header">
          <span class="code-lang">Bash</span>
          <span class="code-title">バックアップ対象の各ディスクをグループに追加</span>
        </div>
        <pre><code class="language-bash"># ゾーンディスクの場合
gcloud compute disks add-resource-policies DISK_NAME \
    --resource-policies=my-consistency-group \
    --zone=us-central1-a</code></pre>
      </div>

      <h3>ステップ 3: コンシステンシーグループのインスタントスナップショットを作成</h3>
      <div class="code-block">
        <div class="code-header">
          <span class="code-lang">Bash</span>
          <span class="code-title">単一コマンドで全ディスクの同一時点スナップショットを作成</span>
        </div>
        <pre><code class="language-bash"># ゾーンディスクのコンシステンシーグループからスナップショット作成
gcloud beta compute instant-snapshot-groups create my-snapshot-group \
    --source-consistency-group=my-consistency-group \
    --zone=us-central1-a</code></pre>
      </div>

      <h3>ステップ 4: (必要に応じて) 一括リストア</h3>
      <div class="code-block">
        <div class="code-header">
          <span class="code-lang">Bash</span>
          <span class="code-title">スナップショットからディスクを一括復元</span>
        </div>
        <pre><code class="language-bash"># コンシステンシーグループのスナップショットからディスクを一括復元
gcloud beta compute disks bulk create \
    --zone=us-central1-a \
    --source-instant-snapshot-group=my-snapshot-group \
    --source-instant-snapshot-group-zone=us-central1-a</code></pre>
      </div>
    </div>

    <!-- Benefits -->
    <div class="section">
      <h2>&#x1F4C8; メリット</h2>

      <h3>&#x1F4BC; ビジネス面</h3>
      <div class="card card-green">
        <div class="icon-text"><span>&#x2713;</span><span><strong>RPO/RTO の短縮</strong>: 複数ディスクのバックアップと復元を一括で実行できるため、データ保護の目標時間を大幅に改善できる</span></div>
        <div class="icon-text"><span>&#x2713;</span><span><strong>運用コストの削減</strong>: 個別ディスクごとのバックアップスクリプトやオーケストレーションが不要になり、運用の複雑さとコストを低減できる</span></div>
        <div class="icon-text"><span>&#x2713;</span><span><strong>追加コストなし</strong>: コンシステンシーグループのインスタントスナップショット機能に追加料金は発生しない</span></div>
      </div>

      <h3>&#x1F6E0;&#xFE0F; 技術面</h3>
      <div class="card card-green">
        <div class="icon-text"><span>&#x2713;</span><span><strong>データ整合性の保証</strong>: 全ディスクが同一時点でスナップショットされるため、ディスク間のデータ整合性が保証される</span></div>
        <div class="icon-text"><span>&#x2713;</span><span><strong>高速な復元</strong>: インスタントスナップショットの特性により、数分以内でのディスク復元が可能</span></div>
        <div class="icon-text"><span>&#x2713;</span><span><strong>API の一貫性</strong>: 既存のインスタントスナップショット API と一貫したインターフェースで利用できる</span></div>
      </div>
    </div>

    <!-- Limitations -->
    <div class="section">
      <h2>&#x26A0;&#xFE0F; デメリット・制約事項</h2>

      <h3>&#x26D4; 制限事項</h3>
      <div class="card card-red">
        <div class="icon-text"><span>&#x2022;</span><span>本機能は現在 <strong>Preview</strong> であり、SLA の対象外。本番環境での利用は慎重に検討が必要</span></div>
        <div class="icon-text"><span>&#x2022;</span><span>インスタントスナップショットは<strong>クラッシュ整合性</strong>であり、アプリケーション整合性ではない。インメモリデータはキャプチャされない</span></div>
        <div class="icon-text"><span>&#x2022;</span><span>ソースディスクが削除されると、そのディスクのインスタントスナップショットも削除される (コンシステンシーグループ内のスナップショットも含む)</span></div>
        <div class="icon-text"><span>&#x2022;</span><span>インスタントスナップショットはソースディスクと同じゾーンまたはリージョンにのみ保存される。災害復旧には標準スナップショットへの変換が必要</span></div>
        <div class="icon-text"><span>&#x2022;</span><span>既存のコンシステンシーグループのインスタントスナップショットに新しいスナップショットを追加することはできない。ディスクグループを更新してから新しいスナップショットグループを作成する必要がある</span></div>
      </div>

      <h3>&#x1F4DD; 考慮すべき点</h3>
      <div class="warning-box">
        <div class="icon-text"><span>&#x26A0;&#xFE0F;</span><span>ゾーン障害やリージョン障害に対する保護にはならない。災害復旧には標準スナップショットまたはアーカイブスナップショットを併用すべき</span></div>
        <div class="icon-text"><span>&#x26A0;&#xFE0F;</span><span>アプリケーション整合性が必要な場合は、スナップショット取得前にアプリケーション側でフラッシュ処理を実施するか、アプリケーション整合性のある標準スナップショットを使用する</span></div>
        <div class="icon-text"><span>&#x26A0;&#xFE0F;</span><span>Preview 機能のため、API やコマンドに変更が入る可能性がある (現在 <code>gcloud beta</code> コマンドを使用)</span></div>
      </div>
    </div>

    <!-- Use Cases -->
    <div class="section">
      <h2>&#x1F4A1; ユースケース</h2>

      <div class="usecase-card">
        <h3>&#x1F5C4;&#xFE0F; ユースケース 1: マルチディスク構成のデータベースバックアップ</h3>
        <p><strong>シナリオ:</strong> データディスク、WAL (Write-Ahead Log) ディスク、設定ディスクの 3 つのディスクで構成されるデータベースサーバーにおいて、メジャーバージョンアップグレード前にバックアップを取得したい。</p>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Bash</span>
            <span class="code-title">マルチディスク DB バックアップの実装例</span>
          </div>
          <pre><code class="language-bash"># 1. コンシステンシーグループを作成
gcloud compute resource-policies create disk-consistency-group db-backup-group \
    --region=asia-northeast1

# 2. 各ディスクをグループに追加
gcloud compute disks add-resource-policies db-data-disk \
    --resource-policies=db-backup-group --zone=asia-northeast1-a
gcloud compute disks add-resource-policies db-wal-disk \
    --resource-policies=db-backup-group --zone=asia-northeast1-a
gcloud compute disks add-resource-policies db-config-disk \
    --resource-policies=db-backup-group --zone=asia-northeast1-a

# 3. アップグレード前に一括スナップショット取得
gcloud beta compute instant-snapshot-groups create db-pre-upgrade-snapshot \
    --source-consistency-group=db-backup-group \
    --zone=asia-northeast1-a

# 4. 問題発生時に一括リストア
gcloud beta compute disks bulk create \
    --zone=asia-northeast1-a \
    --source-instant-snapshot-group=db-pre-upgrade-snapshot \
    --source-instant-snapshot-group-zone=asia-northeast1-a</code></pre>
        </div>
        <div class="success-box">
          <strong>&#x2705; 効果:</strong> 3 つのディスクを同一時点でバックアップすることで、データとログの整合性を保った状態でのロールバックが可能になる。
        </div>
      </div>

      <div class="usecase-card">
        <h3>&#x1F680; ユースケース 2: 分散アプリケーションのリリース前バックアップ</h3>
        <p><strong>シナリオ:</strong> マイクロサービスアーキテクチャにおいて、複数の VM にアタッチされた永続ディスクを、アプリケーションのリリース前に一括でバックアップしたい。</p>
        <div class="success-box">
          <strong>&#x2705; 効果:</strong> リリース後に問題が発生した場合、全ディスクを同一時点の状態にロールバックすることで、サービス間のデータ整合性を維持しながら迅速に復旧できる。
        </div>
      </div>
    </div>

    <!-- Pricing -->
    <div class="section">
      <h2>&#x1F4B0; 料金</h2>
      <div class="note-box">
        <strong>コンシステンシーグループのインスタントスナップショット機能の利用に追加料金は発生しません。</strong>
      </div>
      <p>インスタントスナップショット自体の料金:</p>
      <div class="card">
        <div class="icon-text"><span>&#x2192;</span><span><strong>オペレーション料金</strong>: スナップショット作成時に適用</span></div>
        <div class="icon-text"><span>&#x2192;</span><span><strong>ストレージ料金</strong>: スナップショット取得後にディスク上で変更されたデータ量に基づいて課金。ストレージはソースディスクと同じ料金レートで課金される</span></div>
      </div>
      <p>インスタントスナップショットはインクリメンタル (増分) で保存されるため、変更のないブロックには追加のストレージコストは発生しません。</p>
      <p>詳細な料金情報は <a href="https://cloud.google.com/compute/disks-image-pricing#disk" target="_blank" class="gc-link">Compute Engine ディスクと画像の料金ページ</a> を参照してください。</p>
    </div>

    <!-- Available Regions -->
    <div class="section">
      <h2>&#x1F30D; 利用可能リージョン</h2>
      <p>インスタントスナップショットはソースディスクと同じゾーンまたはリージョンに保存されます。コンシステンシーグループは、<strong>Compute Engine が利用可能な全リージョン</strong>で作成可能です。</p>
      <p>具体的な利用可能リージョンの一覧は <a href="https://cloud.google.com/compute/docs/regions-zones" target="_blank" class="gc-link">Compute Engine リージョンとゾーン</a> を参照してください。</p>
    </div>

    <!-- Related Services -->
    <div class="section">
      <h2>&#x1F517; 関連サービス・機能</h2>
      <div class="related-grid">
        <div class="related-card">
          <h4>&#x1F4F7; Standard Snapshots</h4>
          <p>ゾーン障害・リージョン障害からの保護に対応したリモートバックアップ。インスタントスナップショットから標準スナップショットへの変換も可能。</p>
        </div>
        <div class="related-card">
          <h4>&#x1F6E1;&#xFE0F; Backup and DR Service</h4>
          <p>ポリシーベースのバックアップ管理、監視、レポート機能を提供する包括的なバックアップソリューション。</p>
        </div>
        <div class="related-card">
          <h4>&#x1F5BC;&#xFE0F; Machine Images</h4>
          <p>VM にアタッチされた全ディスクのバックアップに対応。ただしインスタントスナップショットほどの高速復元は不可。</p>
        </div>
        <div class="related-card">
          <h4>&#x1F504; Asynchronous Replication</h4>
          <p>コンシステンシーグループはもともと非同期レプリケーション用に設計された機能であり、今回インスタントスナップショットとの連携が追加された。</p>
        </div>
      </div>
    </div>

    <!-- Summary -->
    <div class="section">
      <h2>&#x1F4DD; まとめ</h2>
      <p>Compute Engine の <span class="highlight">Consistency Groups for Instant Snapshots</span> は、複数ディスクにまたがるワークロードのバックアップと復元を大幅に簡素化する機能です。単一オペレーションでの一括バックアップと一括リストアにより、データ整合性を保ちながら RPO/RTO を短縮できます。</p>
      <div class="warning-box">
        <strong>&#x26A0;&#xFE0F; 注意:</strong> 現在 Preview 段階であるため、本番環境での利用には慎重な評価が推奨されます。マルチディスク構成のデータベースや分散アプリケーションを運用している場合は、検証環境での評価を開始することを推奨します。
      </div>
    </div>

    <!-- Footer -->
    <footer>
      <p><strong>&#x1F3F7;&#xFE0F; タグ:</strong> #ComputeEngine #InstantSnapshots #ConsistencyGroups #Backup #DataProtection #Preview #DisasterRecovery</p>
      <p><strong>&#x1F4CE; 出典:</strong></p>
      <ul>
        <li><a href="https://cloud.google.com/release-notes#February_10_2026" target="_blank" rel="noopener noreferrer">Google Cloud Release Notes (February 10, 2026)</a></li>
        <li><a href="https://cloud.google.com/compute/docs/disks/instant-snapshots" target="_blank" rel="noopener noreferrer">About instant snapshots</a></li>
        <li><a href="https://cloud.google.com/compute/docs/disks/create-instant-snapshots" target="_blank" rel="noopener noreferrer">Create instant snapshots</a></li>
        <li><a href="https://cloud.google.com/compute/docs/disks/restore-instant-snapshot" target="_blank" rel="noopener noreferrer">Restore from instant snapshots</a></li>
        <li><a href="https://cloud.google.com/compute/docs/disks/async-pd/manage-consistency-groups" target="_blank" rel="noopener noreferrer">Manage consistency groups</a></li>
        <li><a href="https://cloud.google.com/compute/docs/disks/data-protection" target="_blank" rel="noopener noreferrer">Data protection options</a></li>
        <li><a href="https://cloud.google.com/compute/disks-image-pricing#disk" target="_blank" rel="noopener noreferrer">Compute Engine Disks and Image Pricing</a></li>
      </ul>
    </footer>

  </div>

  <!-- Mermaid.js -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: 'base',
      themeVariables: {
        primaryColor: '#4285F4',
        primaryTextColor: '#202124',
        primaryBorderColor: '#4285F4',
        lineColor: '#4285F4',
        secondaryColor: '#F1F3F4',
        tertiaryColor: '#FAFAFA',
        background: '#FFFFFF',
        mainBkg: '#E8F0FE',
        nodeBorder: '#4285F4',
        clusterBkg: '#E8F0FE',
        clusterBorder: '#4285F4',
        edgeLabelBackground: '#FFFFFF',
        textColor: '#202124'
      }
    });
  </script>

  <!-- highlight.js -->
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11/build/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
</body>
</html>